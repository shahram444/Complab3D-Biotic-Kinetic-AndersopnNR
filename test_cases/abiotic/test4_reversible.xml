<?xml version="1.0" ?>
<!--
================================================================================
TEST 4: REVERSIBLE REACTION (Equilibrium Approach)
================================================================================
PURPOSE:
  Test reversible first-order reaction approaching equilibrium: A <-> B

REACTION:
  A <-> B (reversible)
  Forward: A -> B with k_f
  Reverse: B -> A with k_r

RATE LAW:
  dA/dt = -k_f * [A] + k_r * [B]
  dB/dt = +k_f * [A] - k_r * [B]

  Net rate = k_f * [A] - k_r * [B]

PARAMETERS:
  k_f = 1.0e-3 [1/s] (forward rate)
  k_r = 5.0e-4 [1/s] (reverse rate)

EQUILIBRIUM CONSTANT:
  K_eq = k_f / k_r = 1.0e-3 / 5.0e-4 = 2.0

  At equilibrium: [B]/[A] = K_eq = 2.0

INITIAL CONDITIONS:
  [A]_0 = 1.0 mol/L
  [B]_0 = 0.0 mol/L

VALIDATION:
  Total concentration: [A] + [B] = 1.0 mol/L (conserved)

  At equilibrium:
    [B]/[A] = 2.0
    [A] + [B] = 1.0

  Solving: [A]_eq = 1.0/3.0 = 0.333 mol/L
           [B]_eq = 2.0/3.0 = 0.667 mol/L

  System should approach these values exponentially.

KINETICS FILE: Use defineAbioticKinetics_test4.hh
================================================================================
-->
<parameters>
    <path>
        <src_path>src</src_path>
        <input_path>input</input_path>
        <output_path>output_abiotic_test4_reversible</output_path>
    </path>

    <simulation_mode>
        <biotic_mode>false</biotic_mode>
        <enable_kinetics>false</enable_kinetics>
        <enable_abiotic_kinetics>true</enable_abiotic_kinetics>
        <enable_validation_diagnostics>true</enable_validation_diagnostics>
    </simulation_mode>

    <LB_numerics>
        <domain>
            <nx>20</nx>
            <ny>10</ny>
            <nz>10</nz>
            <dx>1.0</dx>
            <unit>um</unit>
            <characteristic_length>10</characteristic_length>
            <filename>geometry_open.dat</filename>
            <material_numbers>
                <pore>2</pore>
                <solid>0</solid>
                <bounce_back>1</bounce_back>
            </material_numbers>
        </domain>
        <delta_P>0.0</delta_P>
        <Peclet>0.0</Peclet>
        <tau>0.8</tau>
        <track_performance>false</track_performance>
        <iteration>
            <ade_max_iT>30000</ade_max_iT>
            <ade_converge_iT>1e-12</ade_converge_iT>
        </iteration>
    </LB_numerics>

    <chemistry>
        <number_of_substrates>2</number_of_substrates>

        <substrate0>
            <name_of_substrates>Species_A</name_of_substrates>
            <initial_concentration>1.0</initial_concentration>
            <substrate_diffusion_coefficients>
                <in_pore>1.0e-9</in_pore>
            </substrate_diffusion_coefficients>
            <left_boundary_type>Neumann</left_boundary_type>
            <right_boundary_type>Neumann</right_boundary_type>
            <left_boundary_condition>0.0</left_boundary_condition>
            <right_boundary_condition>0.0</right_boundary_condition>
        </substrate0>

        <substrate1>
            <name_of_substrates>Species_B</name_of_substrates>
            <initial_concentration>0.0</initial_concentration>
            <substrate_diffusion_coefficients>
                <in_pore>1.0e-9</in_pore>
            </substrate_diffusion_coefficients>
            <left_boundary_type>Neumann</left_boundary_type>
            <right_boundary_type>Neumann</right_boundary_type>
            <left_boundary_condition>0.0</left_boundary_condition>
            <right_boundary_condition>0.0</right_boundary_condition>
        </substrate1>
    </chemistry>

    <microbiology>
        <number_of_microbes>0</number_of_microbes>
    </microbiology>

    <equilibrium>
        <enabled>false</enabled>
    </equilibrium>

    <IO>
        <read_NS_file>false</read_NS_file>
        <read_ADE_file>false</read_ADE_file>
        <save_VTK_interval>5000</save_VTK_interval>
        <save_CHK_interval>30000</save_CHK_interval>
    </IO>
</parameters>
